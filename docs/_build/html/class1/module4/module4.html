<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>Lab 4: [Optional] SaaS Federation iApp Lab</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="Lab 4: [Optional] SaaS Federation iApp Lab"/>
  <meta name="product" content="F5 Identity and Access Management Solutions"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2020-05-19 03:36:25"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="F5 Identity and Access Management Solutions" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lab 4: [Optional] SaaS Federation iApp Lab &#8212; F5 Identity and Access Management Solutions  documentation</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5_agility_theme.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/f5.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/index.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/f5-theme.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/CoveoFullSearch.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/21fb8a09c3.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Conclusion" href="../conclusion.html" />
    <link rel="prev" title="Lab 3: Kerberos to SAML Lab" href="../module3/module3.html" /> 
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      <!-- javascript code to maintain the sidebar scroll positon when loaded -->
      <script type="text/javascript">
        $(function() {
          if (localStorage.tempScrollTop) {
            $('#sidebar').scrollTop(localStorage.tempScrollTop);
          }
        });
        $('#sidebar').on("scroll", function() {
          localStorage.setItem("tempScrollTop", $('#sidebar').scrollTop());
        });
      </script>
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>F5 Identity and Access Management Solutions  </h5>
        
<div id="searchbox" role="search">
  <form class="search" action="../../search.html" method="get">
    <input type="text" class="search" name="q" placeholder=" Search..." />
    <button type="submit" class="btn btn-info navbar-btn"><i class="fa fa-search"></i></button>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../class1.html">Class 1: SAML Federation with F5</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../labinfo.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module1/module1.html">Lab 1: SAML Service Provider (SP) Lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module2/module2.html">Lab 2: SAML Identity Provider (IdP) Lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module3/module3.html">Lab 3: Kerberos to SAML Lab</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lab 4: [Optional] SaaS Federation iApp Lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conclusion.html">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../class2/class2.html">Class 2: OAuth Federation with F5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class3/class3.html">Class 3: SWG - Securing Outbound Internet Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class4/class4.html">Class 4: SAML Identity Provider (IdP) Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class5/class5.html">Class 5: AD FS Proxy Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class6/class6.html">Class 6: Federating Common Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class7/class7.html">Class 7: Introduction to Universal Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class8/class8.html">Class 8: Troubleshooting Universal Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class9/class9.html">Class 9: Multi-Factor Auth for Cloud Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class10/class10.html">Class 10: Privileged User Access</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Lab 4: [Optional] SaaS Federation iApp Lab</a><ul>
<li><a class="reference internal" href="#task-1-create-a-new-saas-saml-service-provider-sp">TASK 1 – Create a new SaaS SAML Service Provider (SP)</a></li>
<li><a class="reference internal" href="#task-2-deploy-the-saas-federation-iapp">TASK 2 - Deploy the SaaS Federation iApp</a></li>
<li><a class="reference internal" href="#task-3-modify-the-saml-idp-access-policy">TASK 3 - Modify the SAML IdP Access Policy</a></li>
<li><a class="reference internal" href="#task-4-test-the-saas-federation-application">TASK 4 - Test the SaaS Federation Application</a></li>
</ul>
</li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../../index.html">F5 Identity and Access Management Solutions</a>
              &gt; <a href="../class1.html">Class 1: SAML Federation with F5</a>

          <span class="right">
             <a href="../../_sources/class1/module4/module4.rst.txt" rel="nofollow">Source</a> |
             <a href="https://github.com/osantiago774/f5-agility-labs-iam">Edit on <i class="fa fa-github" aria-hidden="true"></i></a>
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="lab-4-optional-saas-federation-iapp-lab">
<h1>Lab 4: [Optional] SaaS Federation iApp Lab<a class="headerlink" href="#lab-4-optional-saas-federation-iapp-lab" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>The purpose of this lab is to familiarize the Student with the new SaaS
Federation iApp. Students will use the iApp to create a federation
relationship with a commonly used SaaS provider. This lab will leverage
the work performed previously in Lab 3. Archive files are available for
the completed Lab 3.</p>
<p>Objective:</p>
<ul class="simple">
<li>Gain an understanding of the new SaaS Federation iApp and its
features.</li>
<li>Deploy a working SaaS federation using the iApp to a commonly used
SaaS provider</li>
</ul>
<p>Lab Requirements:</p>
<ul class="simple">
<li>All lab requirements will be noted in the tasks that follow</li>
</ul>
<p>Estimated completion time: 25 minutes</p>
<div class="section" id="task-1-create-a-new-saas-saml-service-provider-sp">
<h2>TASK 1 – Create a new SaaS SAML Service Provider (SP)<a class="headerlink" href="#task-1-create-a-new-saas-saml-service-provider-sp" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Navigate to  <strong>Access ‑&gt; Federation ‑&gt; SAML Identity Provider ‑&gt; External
SP Connectors</strong></p>
</li>
<li><p class="first">Click specifically on the <strong>Down Arrow</strong> next to the <strong>Create</strong> button
(far right)</p>
</li>
<li><p class="first">Select <strong>From Metadata</strong> from the drop down menu</p>
<p><img alt="image95" src="../../_images/image34.png" /></p>
</li>
<li><p class="first">In the <strong>Create New SAML Service Provider</strong> dialogue box, click <strong>Browse</strong>
and select the <code class="docutils literal notranslate"><span class="pre">SAMLSP-00D36000000jjkp.xml</span></code> file from the Desktop of your
jump host</p>
</li>
<li><p class="first">In the <strong>Service Provider Name</strong> field, enter: <code class="docutils literal notranslate"><span class="pre">salesforce</span></code></p>
</li>
<li><p class="first">Click <strong>OK</strong> on the dialog box</p>
<p><img alt="image96" src="../../_images/image85.png" /></p>
</li>
</ol>
</div>
<div class="section" id="task-2-deploy-the-saas-federation-iapp">
<h2>TASK 2 - Deploy the SaaS Federation iApp<a class="headerlink" href="#task-2-deploy-the-saas-federation-iapp" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Navigate to <strong>iApps ‑&gt; Application Services -&gt; Applications</strong> and click
on the <strong>Plus (+) Sign</strong> as shown</p>
<p><img alt="image97" src="../../_images/image86.png" /></p>
</li>
<li><p class="first">In the resulting <strong>New Application Service</strong> window, enter <em>saas</em> as the
<em>Name</em></p>
</li>
<li><p class="first">Select <code class="docutils literal notranslate"><span class="pre">f5.saas_idp.v1.0.rc1</span></code> from the <strong>Template</strong> drop down menu</p>
<p><img alt="image98" src="../../_images/image87.png" /></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The iApp template has already been downloaded and imported
for this lab. You can download the latest iApp templates from
<a class="reference external" href="https://downloads.f5.com/">https://downloads.f5.com/</a></p>
</div>
</li>
<li><p class="first">Configure the iApp template as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">SaaS Applications</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Application:</td>
<td><code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">federation</span> <span class="pre">relationship</span> <span class="pre">with</span> <span class="pre">salesforce.com</span></code></td>
</tr>
<tr class="row-odd"><td>SP:</td>
<td><code class="docutils literal notranslate"><span class="pre">salesforce</span></code></td>
</tr>
<tr class="row-even"><td>Display Name:</td>
<td><code class="docutils literal notranslate"><span class="pre">SalesForce</span></code></td>
</tr>
<tr class="row-odd"><td>SP Initiated:</td>
<td><code class="docutils literal notranslate"><span class="pre">No</span></code></td>
</tr>
</tbody>
</table>
<p><img alt="image99" src="../../_images/image88.png" /></p>
<table border="1" class="docutils">
<colgroup>
<col width="64%" />
<col width="36%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">BIG-IP APM Configuration</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>What EntityID do you want to use for your SaaS applications?</td>
<td><code class="docutils literal notranslate"><span class="pre">https://idp.f5demo.com/idp/f5/</span></code></td>
</tr>
<tr class="row-odd"><td>Should the iApp create a new AAA server or use an existing one?</td>
<td><code class="docutils literal notranslate"><span class="pre">f5demo_ad</span></code></td>
</tr>
</tbody>
</table>
<p><img alt="image100" src="../../_images/image89.png" /></p>
<table border="1" class="docutils">
<colgroup>
<col width="78%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">BIG-IP Virtual Server</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>What is the IP address clients will use to access the BIG-IP IdP Service?</td>
<td><code class="docutils literal notranslate"><span class="pre">10.1.10.120</span></code></td>
</tr>
<tr class="row-odd"><td>What port do you want to use for the virtual server?</td>
<td><code class="docutils literal notranslate"><span class="pre">443</span></code></td>
</tr>
<tr class="row-even"><td>Which certificate do you want this BIG-IP system to use for client authentication?</td>
<td><code class="docutils literal notranslate"><span class="pre">idp.f5demo.com.crt</span></code></td>
</tr>
<tr class="row-odd"><td>What is the associated private key?</td>
<td><code class="docutils literal notranslate"><span class="pre">idp.f5demo.com.key</span></code></td>
</tr>
</tbody>
</table>
<p><img alt="image101" src="../../_images/image90.png" /></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We are deploying the iApp on a different IP so that you can see
how everything is built out; however, this IdP will not work, as the
<code class="docutils literal notranslate"><span class="pre">idp.f5demo.com</span></code> FQDN resolves to another IP.
We are going to use the iApp to create the SAML resource that we will
assign to our existing access policy from Lab 3.</p>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="83%" />
<col width="17%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">IdP Encryption Certificate and Key</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Which certificate do you want to use to encrypt your SAML Assertion?</td>
<td><code class="docutils literal notranslate"><span class="pre">SAML.crt</span></code></td>
</tr>
<tr class="row-odd"><td>What is the associated private key?</td>
<td><code class="docutils literal notranslate"><span class="pre">SAML.key</span></code></td>
</tr>
</tbody>
</table>
<p><img alt="image102" src="../../_images/image91.png" /></p>
</li>
<li><p class="first">Scroll to the bottom of the configuration template and click <strong>Finished</strong></p>
</li>
<li><p class="first">Once deployed, you can review the built out SaaS Federation iApp at
<strong>iApps ‑&gt; Application Services ‑&gt; Applications ‑&gt; saas</strong></p>
<p><img alt="image103" src="../../_images/image92.png" /></p>
</li>
<li><p class="first">Review the new virtual servers created by the iApp at <strong>Local Traffic ‑&gt;
Virtual Server ‑&gt; Virtual Server List</strong></p>
<p><img alt="image104" src="../../_images/image93.png" /></p>
</li>
<li><p class="first">Review the new Access Policy built by the iApp at <strong>Access ‑&gt;
Profiles/Policies ‑&gt; Access Profiles (Per-Session Policies)</strong> and select
the <strong>Edit</strong> link next to the <em>saas</em> Access Policy</p>
<p><img alt="image105" src="../../_images/image94.png" /></p>
</li>
<li><p class="first">Test the SaaS iApp by clicking on the bookmark in your browser.</p>
<p><img alt="image106" src="../../_images/image95.png" /></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Navigating to the virtual server by IP will produce a
certificate warning. This is expected. Click through the warning
to see the resulting page.</p>
</div>
</li>
</ol>
</div>
<div class="section" id="task-3-modify-the-saml-idp-access-policy">
<h2>TASK 3 - Modify the SAML IdP Access Policy<a class="headerlink" href="#task-3-modify-the-saml-idp-access-policy" title="Permalink to this headline">¶</a></h2>
<p>The previous task, Task 2, was to provide you an understanding of how the
SaaS Federation iApp can automatically build a configuration for you.</p>
<p>In this task we will be modifying the existing Webtop from prior labs to
add the SaaS SalesForce application.  The purpose of the task is so you
can see the F5Demo App and SalesForce in the same Webtop.</p>
<ol class="arabic">
<li><p class="first">Using the same Access Policy from Lab 3, navigate to <strong>Access ‑&gt;
Profiles/Policies ‑&gt; Access Profiles (Per-Session Policies)</strong> and
click the <strong>Edit</strong> link next to the previously created
<code class="docutils literal notranslate"><span class="pre">idp.f5demo.com-policy</span></code></p>
<p><img alt="image107" src="../../_images/image44.png" /></p>
</li>
<li><p class="first">In the <strong>Visual Policy Editor</strong> window for <code class="docutils literal notranslate"><span class="pre">/Common/idp.f5demo.com‑policy</span></code>,
click the <strong>Advanced Resource Assign</strong> object.</p>
<p><img alt="image108" src="../../_images/image96.png" /></p>
</li>
<li><p class="first">Click the <strong>Add/Delete</strong> link on the Resource Assignment item</p>
<p><img alt="image109" src="../../_images/image97.png" /></p>
</li>
<li><p class="first">Click the <strong>SAML</strong> tab, and select the checkbox next to
<code class="docutils literal notranslate"><span class="pre">/Common/saas.app/saas_SalesForce_saml_resource_sso</span></code></p>
<p><img alt="image110" src="../../_images/image98.png" /></p>
</li>
<li><p class="first">Click the <strong>Update</strong> button at the bottom of the window to complete
the Resource Assignment entry</p>
</li>
<li><p class="first">Click the <strong>Save</strong> button at the bottom of the
<strong>Advanced Resource Assign</strong> window</p>
</li>
<li><p class="first">Repeat steps 2 - 6 with the <strong>Advanced Resource Assign (1)</strong> object</p>
</li>
<li><p class="first">In the <strong>Visual Policy Editor</strong>, click <strong>Apply Access Policy</strong>
(top left), and close the <strong>Visual Policy Editor</strong></p>
<p><img alt="image111" src="../../_images/image99.png" /></p>
</li>
</ol>
</div>
<div class="section" id="task-4-test-the-saas-federation-application">
<h2>TASK 4 - Test the SaaS Federation Application<a class="headerlink" href="#task-4-test-the-saas-federation-application" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Using your browser from the jump host, navigate to the SAML IdP previously
configured at <code class="docutils literal notranslate"><span class="pre">https://idp.f5demo.com</span></code> (or click the provided bookmark)</p>
<p><img alt="image112" src="../../_images/image84.png" /></p>
</li>
<li><p class="first">Were you prompted for credentials? Were you successfully authenticated?
Did you see the webtop with the new SaaS SP application?</p>
</li>
<li><p class="first">Click on the SalesForce icon. Were you successfully authenticated
(via SAML) to the SP?</p>
</li>
<li><p class="first">Review your Active Sessions <strong>(Access ‑&gt; Overview ‑&gt; Active Sessions­­­)</strong></p>
</li>
<li><p class="first">Review your Access Report Logs <strong>(Access ‑&gt; Overview ‑&gt; Access Reports)</strong></p>
</li>
</ol>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="../module3/module3.html" title="Lab 3: Kerberos to SAML Lab" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="../conclusion.html" title="Conclusion" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/index.js"></script>
  <script src="../../_static/js/jquery.appear.js"></script>
  <script src="../../_static/js/printThis.js"></script>
  <script src="/assets/js/bootstrap.min.js"></script>
  <script src="/assets/js/clouddocs.js"></script>
  <script src="/assets/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>